% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/elt.R
\name{load_data}
\alias{load_data}
\title{Load Data into a Database Table with Optional Overwrite or Append Logic}
\usage{
load_data(
  con,
  df,
  table_name,
  schema_name = "BASE",
  param = "SEASON",
  param_vals = NULL,
  overwrite = FALSE,
  ...
)
}
\arguments{
\item{con}{A DBI database connection object.}

\item{df}{A data frame containing the data to be loaded.}

\item{table_name}{A character string specifying the target table name.}

\item{schema_name}{A character string specifying the target schema name. Defaults to \code{'BASE'}.}

\item{param}{A character string specifying the column used to check for and delete existing records. Defaults to \code{'SEASON'}.}

\item{param_vals}{A vector of values for the \code{param} column to be checked and optionally deleted from the destination table. If \code{NULL}, values are inferred from the data frame.}

\item{overwrite}{A logical indicating whether to overwrite the existing table. If \code{TRUE}, the table is fully replaced. If \code{FALSE}, only matching records are removed and new data appended.}

\item{...}{Additional arguments passed to \code{DBI::dbWriteTable()}.}
}
\value{
Invisibly returns the result of \code{DBI::dbWriteTable()}.
}
\description{
Loads a data frame into a specified database schema and table, with support for conditional overwrite or deduplicated appending. The function automatically creates the schema if it does not exist, adds metadata timestamps to the data, and checks for existing records using a filtering parameter (e.g., \code{SEASON}).
}
\details{
\itemize{
\item If \code{overwrite = TRUE}, the table will be dropped and recreated with the new data.
\item If \code{overwrite = FALSE}, the function checks for existing records using \code{param} and \code{param_vals}, deletes matching records, and appends new ones.
\item Automatically adds \code{updated_at} and \code{local_updated_at} timestamp metadata to the input data.
}
}
